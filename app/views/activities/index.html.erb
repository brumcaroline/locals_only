<div class="container">

  <%= form_with url: activities_path, method: :get, class: "d-flex" do %>
    <%= text_field_tag :category,
      params[:category],
      class: "form-control",
      placeholder: "Digite categoria" %>
    <%= text_field_tag :ranking,
      params[:ranking],
      class: "form-control",
      placeholder: "Digite o ranking"
    %>
    <%= select_tag :tags,
      # options_from_collection_for_select(Tag.activity_tags, "id", "tag_name", params[:tags]),
      # grouped_options_for_select(Tag::ACTIVITYTAGS),
      grouped_options_for_select(@tag_hash),
      multiple: true,
      class: "form-control",
      # input_html: {multiple: true, class: "multiple-select", data: { controller: 'select2' }},
      include_blank: true,
      prompt: "Selecione tags...",
      'data-controller': 'tomselect'
    %>
    <%= submit_tag "Search", class: "btn btn-primary" %>
  <% end %>
  <div class="index-title"><h1><strong>Lista de indicações:</strong></h1></div>

  <div class="container-index">
    <div class="card-master">
    <% @activities.each do |activity| %>
      <div class="card-index">
        <%# <img src="https://source.unsplash.com/random/1600x900"/> %>
        <img src= <%= "#{activity.image}" %>/>
          <div class="card-index-infos">
            <div class="infos-lines">
              <h3><strong><%= "Título:" %></strong></h3>
              <p><%= "#{activity.title}" %></p>
            </div>
            <%# <h3><strong>= "Descrição:"</strong></h3> %>
            <%# <p>= "#{activity.description}"</p> %>
            <%# <h3><%= "Datas:" %>
            <%# <p><%= "#{activity.open_date}" %>
            <div class="infos-lines">
              <h3><strong><%= "Endereço:" %></strong></h3>
              <p><%= "#{activity.address}" %></p>
            </div>
            <div class="infos-lines">
              <h3><strong><%= "Tipo:" %></strong></h3>
              <p><%= "#{activity.category}" %></p>
            </div>
            <div class="infos-lines">
              <h3><strong><%= "Tags Associadas:" %></strong></h3>
              <p><%= "#{activity.tags.map { |tag| tag.tag_name }.join(", ")}" %></p>
            </div>
            <div class="infos-lines">
              <h3><strong><%= "Ranking:" %></strong></h3>
              <p><%= "#{activity.ranking}" %></p>
            </div>
            <div>
              <p><%= link_to "Ver mais", activity_path(activity), class: "btn-orange" %></p>
            </div>
          </div>
        </div>
      <% end %>
    </div>
      <div class="map" style="width: 100%; height: 600px;"
        data-controller="map"
        data-map-markers-value="<%= @markers.to_json %>"
        data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
  </div>

    <p><%= link_to "Voltar página principal", root_path,  class: "btn-black" %></p>
</div>
